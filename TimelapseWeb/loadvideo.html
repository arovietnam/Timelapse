<!DOCTYPE html>
<html lang="en">
<head>
    <title></title>
    <link href="assets/css/custom-stylesheet.css" rel="stylesheet" type="text/css" />
    <script src="assets/plugins/jquery-1.10.1.min.js" type="text/javascript"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            var mp4 = getParameterByName('mp4');
            var webm = getParameterByName('webm');
            var jpg = getParameterByName('jpg');//"https://api.evercam.io/v1/cameras/reykjavikharbour/snapshot.jpg.json";//
            var cameraId = getParameterByName('id');
            $.ajax({
                type: "GET",
                crossDomain: true,
                url: "https://api.evercam.io/v1/cameras/" + cameraId + "/live.json",
                beforeSend: function (xhrObj) {
                    xhrObj.setRequestHeader("Authorization", sessionStorage.getItem("oAuthTokenType") + " " + sessionStorage.getItem("oAuthToken"));
                },
                data: { with_data: true },
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (res) {
                    var html = '<video data-setup="{}" poster="' + res.data + '" preload="none" controls="" class="video-js vjs-default-skin video-bg-width" id="vde4b3u05e9y">';
                    html += '<source type="video/mp4" src="' + mp4 + '"></source>';
                    html += '</video>';
                    $("#videoContainer").append(html);
                },
                error: function (xhrc, ajaxOptionsc, thrownErrorc) {
                    var html = '<video data-setup="{}" poster="assets/img/timelapse.jpg" preload="none" controls="" class="video-js vjs-default-skin video-bg-width" id="vde4b3u05e9y">';
                    html += '<source type="video/mp4" src="' + mp4 + '"></source>';
                    html += '</video>';
                    $("#videoContainer").append(html);
                }
            });

            /*var img = new Image();
            img.onerror = function (evt) {
                jpg = "https://api.evercam.io/v1/cameras/" + cameraId + "/snapshot.jpg.json?api_id=c298268b&api_key=600736690c93646b89e3230480978629";
                var img2 = new Image();
                img2.onerror = function (e) {
                    var html = '<video data-setup="{}" poster="assets/img/timelapse.jpg" preload="none" controls="" class="video-js vjs-default-skin video-bg-width" id="vde4b3u05e9y">';
                    html += '<source type="video/mp4" src="' + mp4 + '"></source>';
                    html += '</video>';
                    $("#videoContainer").append(html);
                };
                img2.onload = function (e) {
                    var html = '<video data-setup="{}" poster="' + jpg + '" preload="none" controls="" class="video-js vjs-default-skin video-bg-width" id="vde4b3u05e9y">';
                    html += '<source type="video/mp4" src="' + mp4 + '"></source>';
                    html += '</video>';
                    $("#videoContainer").append(html);
                }
                img2.src = jpg;
            };
            img.onload = function (evt) {
                var html = '<video data-setup="{}" poster="' + jpg + '" preload="none" controls="" class="video-js vjs-default-skin video-bg-width" id="vde4b3u05e9y">';
                html += '<source type="video/mp4" src="' + mp4 + '"></source>';
                html += '</video>';
                $("#videoContainer").append(html);
            };
            img.src = jpg;*/
            
            
        });
        var getParameterByName = function (name) {
            name = name.replace(/[\[]/, "\\\[").replace(/[\]]/, "\\\]");
            var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
                results = regex.exec(location.search);
            return results == null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
        }
    </script>
    <style>
        body{
            margin:0;
            padding:0;
        }
    </style>
</head>
<body>
    <div id="videoContainer">
        <!--<video data-setup="{}" poster="http://144.76.84.113/timelapses/3730/22/22.jpg" preload="none" controls="" class="video-js vjs-default-skin video-bg-width" id="vde4b3u05e9y">
            <source type="video/mp4" src="http://144.76.84.113/timelapses/3730/22/e4b3u05e9y.mp4"></source>
            <source type="video/webm" src="http://144.76.84.113/timelapses/3730/22/e4b3u05e9y.mp4"></source>
        </video>-->
    </div>
</body>
</html>